<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>編輯任務</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f4f7f6;
      --text:#333333;
      --primary:#475569;     /* 石板霧藍 */
      --primary-2:#64748b;   /* hover */
      --muted:#e5e7eb;
      --card:#ffffff;
      --shadow:0 8px 20px rgba(0,0,0,.06);
      --border:#e5e7eb;
      --subtext:#6b7280;
    }
    *{box-sizing:border-box}
    body{
      font-family:'Roboto','Segoe UI',Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      margin:0;
      padding:32px 16px;
    }
    .container{max-width:720px;margin:0 auto}
    .card{
      background:var(--card);
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:28px 24px;
    }
    h1{font-size:22px;margin:0 0 10px;text-align:center;color:var(--primary)}
    .sub{text-align:center;color:var(--subtext);margin:0 0 20px}
    form{display:grid;gap:16px}
    label{font-weight:600;margin-bottom:6px;display:block;color:var(--primary)}
    input,select,textarea{
      width:100%;padding:12px 14px;border:1px solid var(--border);
      border-radius:12px;font-size:14px;background:#fff;color:var(--text);
      outline:none;transition:border .15s ease, box-shadow .15s ease;
    }
    textarea{resize:vertical;min-height:120px}
    input:focus,select:focus,textarea:focus{
      border-color:var(--primary-2);
      box-shadow:0 0 0 4px rgba(100,116,139,.15);
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .actions{display:flex;gap:12px;justify-content:flex-end;margin-top:8px}
    .btn{
      appearance:none;border:none;border-radius:999px;
      padding:10px 18px;font-weight:600;cursor:pointer;
      transition:background .2s,color .2s,transform .1s,box-shadow .2s;
    }
    .btn.primary{background:var(--primary);color:#fff}
    .btn.primary:hover{background:var(--primary-2);transform:translateY(-1px);box-shadow:0 6px 12px rgba(0,0,0,.12)}
    .btn.secondary{background:var(--muted);color:#374151;text-decoration:none;display:inline-flex;align-items:center}
    .btn.secondary:hover{background:#f1f5f9}
    .meta{font-size:12px;color:var(--subtext);text-align:right;margin-top:6px}
    .back{
      display:inline-flex;align-items:center;gap:6px;
      text-decoration:none;color:var(--primary);font-weight:600;margin-bottom:14px;
    }
    .back:hover{color:var(--primary-2)}
  </style>
</head>
<body>
  <div class="container">
    <a class="back" href="{{ url_for('index') }}">← 返回清單</a>
    <div class="card">
      <h1>Edit</h1>

      <form method="post">
        <div>
          <label for="task">任務</label>
          <input id="task" name="task" value="{{ todo.task }}" required />
        </div>

        <div class="row">
          <div>
            <label for="category">分類</label>
            <select id="category" name="category">
              <option value="work"   {{ 'selected' if todo.category=='work'  }}>WORK</option>
              <option value="school" {{ 'selected' if todo.category=='school'}}>SCHOOL</option>
              <option value="other"  {{ 'selected' if todo.category=='other' }}>OTHER</option>
            </select>
          </div>

          <div>
            <label for="status">狀態</label>
            <select id="status" name="status">
              <!-- 這裡用回資料庫的中文值，避免 ENUM 衝突 -->
              <option value="未完成" {{ 'selected' if todo.status in ('未完成','Pending') }}>未完成</option>
              <option value="完成"   {{ 'selected' if todo.status in ('完成','Done')   }}>完成</option>
            </select>
          </div>
        </div>

        <div>
          <label for="note">備註</label>
          <textarea id="note" name="note" placeholder="…">{{ todo.note or '' }}</textarea>
        </div>

        <div class="actions">
          <a class="btn secondary" href="{{ url_for('index') }}">取消</a>
          <button class="btn primary" type="submit">儲存變更</button>
        </div>

        {% if todo.updated_at %}
          <div class="meta">最後更新：{{ todo.updated_at }}</div>
        {% endif %}
      </form>
    </div>
  </div>
</body>
</html>
