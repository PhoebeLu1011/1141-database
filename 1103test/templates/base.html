<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Medical Analytics</title>

  <!-- ✅ Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* ==== 延續你的莫蘭迪色系 ==== */
    :root{
      --color-bg:#f5f4f2;
      --color-card:#ffffff;
      --color-accent:#b8b0a0;
      --color-text:#3f3f3f;
      --color-link:#6b7a8f;
      --color-link-hover:#4f5c6b;
      --color-border:#d8d5d0;
    }
    body{
      background:var(--color-bg);
      color:var(--color-text);
      font-family:"Noto Sans TC","Segoe UI",Helvetica,Arial,sans-serif;
      letter-spacing:.3px;
    }
    .navbar-brand, h1,h2,h3 { color:var(--color-accent) !important; }
    .card, .table { background:var(--color-card); }
    .btn-primary{
      background:var(--color-link); border-color:var(--color-link);
    }
    .btn-primary:hover{ background:var(--color-link-hover); border-color:var(--color-link-hover); }
    .border-soft{ border:1px solid var(--color-border) !important; }
    .table thead th{
      background:#f0efec; color:#555; font-weight:600;
    }
    /* 讓 summary 有你原本的風格 */
    details summary{ cursor:pointer; color:var(--color-accent); font-weight:500; }
  </style>
</head>
<body>

<!-- ✅ Navbar -->
<nav class="navbar navbar-expand-lg bg-white border-soft rounded-3 container mt-3 px-3">
  <a class="navbar-brand fw-semibold" href="#" style="letter-spacing:.5px;">Medical Analytics</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div id="navMenu" class="collapse navbar-collapse">
    <ul class="navbar-nav ms-auto gap-2">
      <li class="nav-item"><a class="nav-link" href="{{ url_for('home') }}">資料列表</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('upload') }}">上傳 CSV</a></li>
      <li class="nav-item"><a class="nav-link" href="{{ url_for('demo') }}">Search</a></li>
    </ul>
  </div>
</nav>

<main class="container my-4">

  <!-- ✅ Flask flash messages → Bootstrap Alerts -->
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-info border-soft" role="alert">
        {% for m in messages %}
          <div class="mb-1">{{ m }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- ✅ Quick Add Form（Bootstrap Grid） -->
  <div class="card border-soft rounded-4 p-3 p-md-4 mb-4">
    <h3 class="h5 mb-3">Quick Add</h3>
    <form method="post" action="{{ url_for('quick_add') }}">
      <div class="row g-3">
        <div class="col-12 col-md-3">
          <label class="form-label">Patient ID</label>
          <input class="form-control" name="patient_id" placeholder="A001" required>
        </div>
        <div class="col-12 col-md-4">
          <label class="form-label">時間 (local)</label>
          <input class="form-control" type="datetime-local" name="timestamp" required>
        </div>

        <div class="col-6 col-md-1">
          <label class="form-label">HR</label>
          <input class="form-control" type="number" name="hr" step="0.1" min="0" placeholder="80">
        </div>
        <div class="col-6 col-md-1">
          <label class="form-label">BP Sys</label>
          <input class="form-control" type="number" name="bp_sys" step="0.1" min="0" placeholder="120">
        </div>
        <div class="col-6 col-md-1">
          <label class="form-label">BP Dia</label>
          <input class="form-control" type="number" name="bp_dia" step="0.1" min="0" placeholder="80">
        </div>
        <div class="col-6 col-md-1">
          <label class="form-label">SpO₂</label>
          <input class="form-control" type="number" name="spo2" step="0.1" min="0" max="100" placeholder="98">
        </div>
        <div class="col-6 col-md-1">
          <label class="form-label">Temp</label>
          <input class="form-control" type="number" name="temp" step="0.1" min="0" placeholder="36.6">
        </div>

        <div class="col-12 d-flex justify-content-end mt-2">
          <button type="submit" class="btn btn-primary px-4">新增 / 更新</button>
        </div>
      </div>
    </form>
  </div>

  {% block content %}{% endblock %}
</main>

<!-- ✅ 預設填入當下時間 -->
<script>
  (function setNow(){
    const input=document.querySelector('input[name="timestamp"]');
    if(!input) return;
    const d=new Date();
    const pad=n=>String(n).padStart(2,'0');
    const local=`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;
    input.value=local;
  })();
</script>

<!-- ✅ Bootstrap JS Bundle (含 Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
